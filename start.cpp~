// this file will take a document for which you want some similar documents 
// code starts here 
#include<iostream>
#include<cstdio>
#include<cstdlib>
#include<cstring>
#include "./class/stopwords.cpp"
#include "./class/index1.cpp"
using namespace std;
int main()
{
stopword s1;
index1 s2;			
			/*This section will make index file of the document that is uploaded */

// store the stop words 
s1.stoplist("stopwords.txt","r");
//make index of file that is uploaded 
s2.makeindex(s1,"upload.txt","r");
//copy index to a file
s2.upload1("baseindex.txt","w");

				/* ends here */


			/* this section will make index of each document in the  document pool */

int maxfiles=100; // maximum files in document pools
int k,total,len1,i;
char copy[100];
char **str=(char **)malloc(sizeof(char *)*maxfiles); // this array will hold the name  of files  in the document pool
file f1;
if(f1.popen("ls ./files/ | cut -c-100","r")==NULL)
{
printf("failed to run command\n");
exit(0);
}
for(i=0;i<maxfiles;i++)
{
str[i]=(char *)malloc(sizeof(char)*100); 
}

total=0;
while(f1.fgets(str[total],sizeof(str[total])-1)!=NULL)
{
if(strcmp(str[total],"\n")!=0)
{
len1=strlen(str[total]);
if(str[total][len1-1]=='\n')
{
str[total][len1-1]='\0';
}
//printf("%s",str[total]);
total++;
}	
}
		
k=0;
while(k<total)
{
strcpy(copy,"./files/");
strcat(copy,str[k]);
index1 s3;
s3.makeindex(s1,copy,"r");
strcpy(copy,"./index/");
strcat(copy,str[k]);
s3.upload1(copy,"w");
k++;
}

			/* ends here */
return 0;
}
